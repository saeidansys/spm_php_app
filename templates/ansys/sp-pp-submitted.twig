<!DOCTYPE html>
<html lang="en">
<head>
    <title>Ansys - Service Partner Portal - {{ spname }}</title>

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/ansys_site.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="DataTables/datatables.min.css"/>
    <link rel="stylesheet" type="text/css" href="DataTables/DataTables-1.11.2/css/dataTables.bootstrap5.min.css"/>
    <link rel="stylesheet" type="text/css" href="DataTables/Buttons-2.0.0/css/buttons.dataTables.min.css"/>
    <link rel="stylesheet" type="text/css" href="DataTables/Select-1.3.3/css/select.dataTables.min.css"/>
    <link rel="stylesheet" type="text/css" href="DataTables/Buttons-2.0.0/css/buttons.bootstrap5.min.css"/>
    <link rel="stylesheet" type="text/css" href="DataTables/SearchPanes-1.4.0/css/searchPanes.bootstrap5.min.css"/>

    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="DataTables/datatables.min.js"></script>

    <style>
        th, td {
            white-space: nowrap;
        }
        td[contenteditable="true"] {
            background-color: #fffbe6;
            border: 1px dashed #ff0000;
            cursor: text;
        }
    </style>

</head>
<body style="background-color: #000000;">

<div class="container-fluid mt-5 mb-5 p-3 rounded rounded-3" style="background-color: #ffffff; max-width: 90%;">

    <div class="row">
        <img src="/img/R.png" />
    </div>

    <div class="row">
        <h1>Service Partner Portal - {{ spname }}</h1>
    </div>

    <div class="row">
        <h2>Project Plan Submission Results</h2>
    </div>

    <table class="table table-striped w-100" id="uploadedrows">
        <thead>
        <tr>
            <th>Consumed Update Date</th>
            <th>SP PO NÂ°</th>
            <th>Project ID</th>
            <th>Measurement Reporting Unit ( Hr, Day, Money)</th>
            <th>Baseline</th>
            <th>Consumed</th>
            <th>SP Rate</th>
            <th>SP Currency</th>
            <th>Project Start Date  ( MM/DD/YYYY)</th>
            <th></th>
            <th></th>
            <th>Project End date ( MM/DD/YYYY)</th>
            <th></th>
            <th></th>
            <th>SP Resource Type</th>
            <th>Project Task/WP Name</th>
            <th>Project Activity Name</th>
            <th>Executive Summary</th>
            <th>SP Unique Identifier</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>Month</td>
            <td>Day</td>
            <td>Year</td>
            <td>Month</td>
            <td>Day</td>
            <td>Year</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        {% for uploadedrow in uploadeddata %}
            <tr>
                <td>{{ uploadedrow.consumed_update_date }}</td>
                <td>{{ uploadedrow.sppon }}</td>
                <td>{{ uploadedrow.project_id }}</td>
                <td>{{ uploadedrow.project_type }}</td>
                <td>{{ uploadedrow.baseline }}</td>
                <td>{{ uploadedrow.consumed_actual }}</td>
                <td>{{ uploadedrow.sp_rate }}</td>
                <td>{{ uploadedrow.sp_currency }}</td>
                <td>{{ uploadedrow.psd_month }}</td>
                <td>{{ uploadedrow.psd_day }}</td>
                <td>{{ uploadedrow.psd_year }}</td>
                <td>{{ uploadedrow.ped_month }}</td>
                <td>{{ uploadedrow.ped_day }}</td>
                <td>{{ uploadedrow.ped_year }}</td>
                <td>{{ uploadedrow.sp_res_type }}</td>
                <td>{{ uploadedrow.project_task }}</td>
                <td>{{ uploadedrow.project_activity_name }}</td>
                <td>{{ uploadedrow.executive_summary }}</td>
                <td>{{ uploadedrow.sp_unique_id }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <div class="row">
        <a class="btn btn-primary" href="/spdashboard/{{ spid }}?c={{ spid64 }}" target="_blank">Dashboard</a>
    </div>

    <script>
        let tableuploaded = new DataTable('#uploadedrows', {
            'scrollX': true,
            dom: 'Blfrtip',
            select: false,
            'ordering': false,
            buttons: [
                {extend: 'excelHtml5', header: true, title: ''}
            ]
        });
    </script>

</div>

<div id="loading-overlay">
    <div id="loader-container" class="d-flex justify-content-center">
        <div class="spinner-border text-light" style="width: 3rem; height: 3rem;" role="status" onclick="showLoadingScreen(this)"></div>
    </div>
</div>

<script>

    function showLoadingScreen(eventsender)
    {
        document.getElementById('loading-overlay').style.display = "block";
    }

    window.onunload = function() {
        document.getElementById('loading-overlay').style.display = "none";
    }

</script>

</body>
</html>
